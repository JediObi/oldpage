### **ECC**

ECC，椭圆曲线加密安全性依赖于计算离散对数的难度，单向的公钥加密系统，一方产生秘钥对，再传播公钥，之后双方加密传输对称秘钥。

ECC使用简化的椭圆曲线方程，使用有限域上的abel群。

(1) 椭圆曲线方程
```
y^2 =  x^3 + a * x + b
```

(2) abel群 加法运算
```
P(x1,y1), Q(x2,y2), R(x3,y3)
加法运算: P + Q = R
坐标值满足以下关系:
x3 = m^2 - x1 -x2
y3 = m * (x1 - x3) - y3
(1) m = (y1-y2)/(x1-x2)，P!=Q；
(2) m = (3*x^2+a)/(2*y)，P=Q.
常数乘法可由以上式子计算
P+P=2P
2P+P=3P
...
nP=(n-1)P+P
```

(3) 有限域
```
y^2 =  x^3 + a * x + b (mod p)，p为质数
x3 = m^2 - x1 -x2 (mod p)
y3 = m * (x1 - x3) - y3 (mod p)
```

(4) 产生公钥和私钥
```
任意取基点G，G的阶为n， nG = 0
从 [1,n-1] 中取一个整数k作为私钥，计算 K = kG，公钥(K,G)
难度保障：
(1) G(x1,y1)
(2) G+G 求解 2G(x2,y2)
m1 = (3*x1^2+a)/(2*y1)
x2 = m1^2 - 2*x1 (mod p)
y2 = m1 * (x1 - x2) - y1 (mod p)
(3) 2G+G 求解3G(x3,y3)
m2 = ...
x3 = m2^2 - x1 - x2 (mod p)
y3 = m2 * (x1 - x3) - y1 (mod p)
...
(n) (k-1)G+G求解kG(xk,yk)
m[k-1] = ...
xk = m[k-1]^2 - x[k-1] - x1 (mod p)
yk = m[k-1] * (x1 - xk) - y1 (mod p)

可以看出计算离散对数求k
已知K(xk,yk),G(x1,y1),p
求k
xk+cp = m[k-1]^2 - x[k-1]，只能够暴力破解。
```


(5) 加密和解密
```
1、用户A选定一条椭圆曲线Ep(a,b)，并取椭圆曲线上一点，作为基点G。
2、用户A选择一个私有密钥k，并生成公开密钥K=kG。
3、用户A将Ep(a,b)和点K，G传给用户B。
4、用户B接到信息后 ，将待传输的明文编码到Ep(a,b)上一点M（编码方法很多，这里不作讨论），并产生一个随机整数r（r<n）。
5、用户B计算点C1=M+rK；C2=rG。
6、用户B将C1、C2传给用户A。
7、用户A接到信息后，计算C1-kC2，结果就是点M。因为
C1-kC2=M+rK-k(rG)=M+rK-r(kG)=M
再对点M进行解码就可以得到明文。
```
