### **数论基础**



(1) 模运算法则
+ 模运算

```
a mod b 
a除以b取余数
```

+ 模运算法则

```
(a + b) mod p = (a mod p + b mod p) mod p 
(a - b) mod p = (a mod p - b mod p) mod p 
(a * b) mod p = (a mod p * b mod p) mod p 
(a^b) mod p = ((a mod p)^b) mod p
```

(2) 同余式

```
m mod b = n mod b
写作 m = n (mod b)
```

(3) 欧拉函数 

正整数n，小于n且与n互质的正整数的个数，写作φ(n) 
+ 1. φ(1)=1
+ 2. 如果n为质数，则 φ(n)=n-1
+ 3. 如果n=p * q，且p，q互质，则 φ(n) = φ(p) * φ(q)
+ 4. 如果n=p^a，且p为质数，则 φ(n)=p^a - p^(a-1)
+ 5. 如果n=(p1^a1) * (p2^a2) * (p3^a3) ... (pk^ak)，且p1~pk均为质数(因为任意正整数都可以分解为质数的乘法)，则
φ(n) = n * (1-1/p1) * (1-1/p2) * (1-1/p3) ... (1-1/pk)

```
证明：
p,q互质，则p^n,q^m仍然互质，
所以根据引理3，可得φ(n)=φ(p1^a1) * φ(p2^a2) * φ(p3^a3) ... φ(pk^ak);
然后根据引理4，可得
φ(n)=(p1^a1-p1^(a1-1)) * (p2^a2-p2^(a2-1)) * (p3^a3-p3^(a3-1)) ... (pk^ak-pk^(ak-1))
    =(p1^a1) * (1-1/p1) * (p2^a2) * (1-1/p2) * (p3^a1) * (1-1/p3) ... (pK^aK) * (1-1/pK)
    =n * (1-1/p1) * (1-1/p2) * (1-1/p3) ... (1-1/pk)
```

(4) 欧拉定理

正整数n和整数a互质 

a^φ(n) = 1 (mod n)

```
证明：
对于正整数n，小于n且与n互质的正整数的个数为φ(n)，这是欧拉函数。
现在列出这φ(n)个与n互质的正整数：
x1,x2,x3, ... xφ(n)
设 m1=a * x1, m2=a * x2, m3=a * x3, ... mφ(n) = a * xφ(n)
(1) 从m中任取两个mr，ms，假设 ms > mr，
     有 ms mod n !=  mr mod n
     证明：
                假设 ms mod n =  mr mod n，
                则有 ms-mr=a * (xs-xr)=(p * n+r)-(q * n+r)=(p-q) * n，p,q,r均为整数，得到等式 a * (xs-xr)=(p-q) * n，
                因为a，n互质，xr<xs<n，所以等式不可能整除， (p-q) 不存在，
                所以，假设不成立，证明完毕。
       所以，
(2) 任意m除以n的余数都与n互质，
    证明：
        因为如果余数与n有公因子r，那么a * xi=p * n+q * r= r * k，则 a*xi与n不互质，而这是不可能的。
        那么这些数除以n的余数都与n互质，而余数又小于n，所以都在x1,x2,x3……xφ(n)中，因为这是1~n中与n互质的所有数。
        由(1)可知m1~mφ(n)模n运算有φ(n)个余数，所以这些余数的某个排列必然等于x1,x2,x3……xφ(n)。

由 (1) (2) 可得
m1 * m2 * m3 ... mφ(n) = x1 * x2 * x3 ... xφ(n) (mod n)
a^φ(n) *  x1 * x2 * x3 ... xφ(n) =  x1 * x2 * x3 ... xφ(n) (mod n)
a^φ(n = 1 (mod n) 
```

(5) 原根

设m是正整数，a是整数，若a模m的阶等于φ(m)，则称a为m的一个原根。 
(a mod m)! = φ(m)

(6) 离散对数

离散对数：首先定义一个素数p的原根，为其各次幂产生从1 到p-1的所有整数根，也就是说，如果a是素数p的一个原根，那么数值 a mod p,a2 mod p,...,ap-1 mod p 是各不相同的整数，并且以某种排列方式组成了从1到p-1的所有整数. 对于一个整数b和素数p的一个原根a，可以找到惟一的指数i，使得 b = a^i mod p 其中0 ≤ i ≤ （p-1） 指数i称为b的以a为基数的模p的离散对数或者指数.该值被记为inda,p(b).